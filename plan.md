## Общие идеи
В настоящий момент personal-kuudere страдает от проблем, связанных с тяжелым прошлым
и происхождением из небольшого набора хендлеров, которые записывались в столбик
в одном файле вперемешку с SQL вызовами.

Система никаким простым и очевидным образом не разворачивается, и не поддерживает
миграции БД, соответственно, требует большого количества ручной работы с базой
при переносе или изменении. В идеале хотелось бы добиться автоматического развёртывания,
простого экспорта/импорта текущего состояния и несложного написания новых модулей
для команд или задач планировщика.

Давно пора добавить автоматическую регистрацию пользователей. Релевантный момент
к размышлению - поддержка разделения (первоочерёдно, ограничения) функционала по
чатам.

Очевидной выглядит связка с просмотрщиком логов телеги (плюс тот скрипт гораздо более
прост, и его легче довести до более-менее завершённого уровня, учитывая, что
формат экспорта из телеграма устаканился и стал относительно приличным).

#### Проблемы со свалками методов
Технически некое разделение кода по файлам существует, но оно чисто функциональное, 
и код, занимающийся _примерно одинаковыми_ по сути действиями, свален в огромные кучи 
методов в "классах", которые нужны исключительно для хранения и проброса инициализации 
общих мест доступа. Примеры - `utils.db_wrapper2.DataInterface` с 91 методом
работы с базой (не удивлюсь, если часть уже дублирует друг друга с небольшими поправками),
которые изначально были вынесены из всего кода в одно место, потом завёрнуты в SQLAlchemy,
а затем и в отдельный класс; а также `handlers.HandlersStructure` с 30 методами хендлеров.

#### Решение 
Тематически распределить все хендлеры (а также их специфические методы работы с БД)
по отдельным модулям, обеспечив достаточно простое подключение (желательно, 
одной строкой в конфиге) и написание новых (начало в некотором смысле положено в `handler_modules`).
Унифицировать обработку входных данных и непосредственную отсылку сформированного
сообщения, чтобы фактический (бизнес-)код отдельных хендлеров был максимально отстранён
от апи телеграм бота.
Методы-обёртки запросов БД более общего плана - запихнуть в классы SQLAlchemy.
Добавить плагин для миграций (рассмотреть переход на Django?)

Упростить систему сборки набора хендлеров (в `main` из `handlers.HandlersStructure.handlers_list`)

#### Проблемы с классами связей с внешним миром
В отличие от предыдущего пункта, `parsers.feed_parser` и `parsers.list_parser`
слегка структурированы, и имеют некий ОО смысл. Тем не менее, они делают слишком много
всего, применяя весьма сомнительные алгоритмы, часто записанные стеной ветвлений.

#### Решение
Для `parsers.list_parser.ListImporter` - реализовать или найти примерно
аналогичную Jikan обёртку для Anilist, и завернуть их обе в одинаковые адаптеры.
Вынести обработку потенциальных ошибок и повторов в настройки requests (Session),
аналогично - для `utils.jikan_custom`.

Для `parsers.feed_parser.TorrentFeedParser` - отделить получение свежих записей из фида
от парсинга ([anitopy](https://github.com/igorcmoura/anitopy)) с сохранением.

kinda relevant - Переместить логику обновления статусов онгоинг сериалов из триггера SQL в код.

#### Прочее
1. Навести порядок с множащимися местами с женерик именами util*
2. упорядочить работу с временем вместо использования разных хаков (пакеты arrow, pendulum?)
3. реализовать для хендлеров единый интерфейс для работы с релевантными себе коллбеками
(вместо одного метода с кучей случайных строк). Предположительно - для каждой кнопки в
callback_data помещается имя хендлера (команды), параметр (например, mal_aid) и,
опционально, действие, а приёмник коллбеков забрасывает его в модуль на обработку.
Пример - быстрый выбор другого тайтла в выдаче /seen.
4. продумать экспорт сезонных данных по запросу, с возможностью обращения к прошлым сезонам
(благо данные трекинга на боте теперь по факту хранятся)
5. Настроить одыкватное логирование, особенно для отслеживания изменений со стороны связей
с анимешными сервисами, а также выключить алхимический дефолтный дебаг и выкинуть всякие
print() проверки
6. каждый раз при ворошении потрошков, связанных с распознаванием аниме и отслеживанием,
вылезает какой-нибудь странный баг, пора бы уже продумать тесты...
7. ...
8. TBD